<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    global vein string:import;
    global active_tab string:tab_edit;
    global parent_screen_name string:contents;
    global docma_running python: hasattr(here, 'service_docma') and here.service_docma.try_connection_and_pw();
    global silva_permissions here/get_silva_permissions;
    "
  i18n:domain="silva">

<metal:block use-macro="here/macro_index/macros/master">
<metal:block fill-slot="main">

<tal:condition condition="here/REQUEST/focus | nothing">
  <script language="JavaScript"
    tal:content="string:document.location = 'tab_edit_import#${here/REQUEST/focus}';">
  </script>
</tal:condition>

<table class="columns columns2">
  <tbody>
    <tr>
      <tal:block replace="nothing">
        _____________________ sidebar _____________________
      </tal:block>
      <td class="left">
        <tal:block replace="nothing">
          ______________ vein navigation ______________
        </tal:block >
        <metal:use-macro use-macro="here/macro_vein_navigation/macros/vein">
          <metal:fill-slot fill-slot="sidebar">
            <tal:block replace="structure python: here.service_sidebar.render(model, 'tab_edit_import', vein)" />
          </metal:fill-slot>
        </metal:use-macro>
      </td>

    <tal:block replace="nothing">
      _____________________ main _____________________
    </tal:block>
    <td class="main">

<form action="." enctype="multipart/form-data" method="post">
  <table class="listing">
    <thead>
      <tr tal:replace="nothing">
        ______________ vein + title row ______________
      </tr>
      <tr>
        <td class="top"
          colspan="3">
          <h2 tal:attributes="title string:id: ${model/id}">
            <img tal:replace="structure icon" />
            <tal:block i18n:translate="">import in &#xab;<tal:block content="title" i18n:name="title"/>&#xbb;</tal:block>
          </h2>
        </td>
      </tr>
      <tr class="top-controls">
        <td colspan="2">
          <a class="transporter"
            style="float: right;"
            href="tab_status_export"
            title="over to the export screen: alt-e"
            accesskey="e"
            i18n:attributes="title"
            i18n:translate="">
            export...
          </a>
          <h3 i18n:translate="">
            import and extract zip archive
          </h3>
        </td>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th width="50%"
          i18n:translate="">
          element
        </th>
        <th i18n:translate="">
          content
        </th>
      </tr>
      <tr class="odd">
        <td class="designator">
          <label for="importfile"
            i18n:translate="">file to upload</label><span class="warning">*</span>
          <p i18n:translate="">
            Locate a zip file containing Assets or a zip file created
            by a Silva full media export.
          </p>
        </td>
        <td class="field">
          <input type="file"
            id="importfile"
            name="importfile"
            size="45"
            title="browse for a file on your disk"
            i18n:attributes="title"
          />
        </td>
      </tr>
      <tr class="even">
        <td class="designator">
          <label for="importfile"
            i18n:translate="">
            title for assets
          </label>
          <p i18n:translate="">
            Set a title for all Assets created from the contents
            of a zip file with Assets.
          </p>
        </td>
        <td class="field align-right">
          <input class="store"
            type="text"
            id="title"
            name="title"
            size="40"
            title="Optional title for all assets"
            i18n:attributes="title"
          />
        </td>
      </tr>
      <tr class="odd">
        <td class="designator">
          <label for="recreate_dirs"
            i18n:translate="">
            subdirectories
          </label>
          <p i18n:translate="">
            Recreate the subdirectory structure of a zip file with Assets by
            adding Silva Folders.
          </p>
        </td>
        <td class="field align-right">
          <input class="min"
            type="checkbox"
            id="recreate_dirs"
            name="recreate_dirs"
            checked="checked"
          />
        </td>
      </tr>

      <tr class="even">
        <td class="designator">
          <label for="replace_content"
            i18n:translate="">
            replace content
          </label>
          <p i18n:translate="">
            Replace Content Objects with the Objects from the import when
            they have the same ids (Note: they will be replaced *even* when
            published).
          </p>
        </td>
        <td class="field align-right">
          <input class="min"
            type="checkbox"
            id="replace_content"
            name="replace_content"
          />
        </td>
      </tr>

      <tr class="controls">
        <td class="align-right"
          colspan="2">
          <input class="button"
            type="submit"
            value="import zip"
            name="import_archive_file:method"
            title="access key: alt-z"
            accesskey="z"
            i18n:attributes="value;title"
          />
        </td>
      </tr>
    </tbody>
  </table>
</form>


<tal:block replace="nothing">
  ____________________________ docma facilities ____________________________
</tal:block>

<tal:condition condition="docma_running">

<tal:define define="
  global user here/REQUEST/AUTHENTICATED_USER;
  global userid user/getId;
  global queue here/service_docma/get_queue;
  global qls python:len(queue) != 0;
  global processingident here/service_docma/get_processing_ident;" />

<form class="sublisting" action="." enctype="multipart/form-data" method="post">
  <table class="listing">
    <thead>
      <tr tal:replace="nothing">
        ______________ vein + title row ______________
      </tr>
      <tr>
        <td class="top"
          colspan="5">
          <h2>
            <img class="icon"
              border="0"
              width="16"
              height="16"
              alt="docma icon"
              tal:attributes="src string:${root_url}/globals/docma.png"
              i18n:attributes="alt"
            />
            <span i18n:translate="">docma facilities</span>
          </h2>
        </td>
      </tr>
    </thead>

    <tbody>
      <tr tal:replace="nothing">
        ______________ upload word file ______________
      </tr>
      <tr class="top-controls">
        <td colspan="3">
          <h3 i18n:translate="">
            upload a document in word format (.doc) for conversion
          </h3>
        </td>
      </tr>

      <tr>
        <th class="align-right"
          width="15%"
          i18n:translate="">
          element
        </th>
        <th i18n:translate="">
          content
        </th>
        <th width="40%"
          i18n:translate="">
          note
        </th>
      </tr>

      <tr class="odd">
        <td class="align-right">
          <span i18n:translate="">file to upload</span><span class="warning">*</span>
        </td>
        <td>
            <input type="file" size="40" name="importfile" />
        </td>
        <td align="right" i18n:translate="">
          Locate a Word file to upload. It'll be converted and appear in the list of processed items below. It can be imported anywhere in Silva.
        </td>
      </tr>

      <tr class="even">
        <td class="align-right">
          <span i18n:translate="">email address</span><span class="warning">*</span>
        </td>
        <td>
          <input class="store"
            type="text"
            name="email"
            tal:attributes="
              value python:here.service_members.get_member(user.getId()).email() or ''"
          />
        </td>
        <td i18n:translate="">
          An e-mail will be sent to you when the item is processed.
        </td>
      </tr>

      <tr class="odd">
        <td class="align-right" i18n:translate="">
          description
        </td>
        <td>
          <textarea name="description"
            class="store"
          ></textarea>
        </td>
        <td i18n:translate="">
          This description will be shown in the queue and the list of processed items.
        </td>
      </tr>

      <tr class="inter-controls">
        <td class="align-right"
          colspan="3">
          <input class="button"
            type="submit"
            value="upload"
            name="tab_edit_import_docma:method"
            title="upload a word document from your local drive: alt-u"
            accesskey="u"
            i18n:attributes="value;title"
          />
        </td>
      </tr>
    </tbody>
  </table>
</form>

<span tal:replace="nothing">
  _____________________ docma queue: processing list + finished jobs _____________________
</span>
<tal:define define="
    global format string:silva;
    global refresh_page string:tab_edit_import;
">
<metal:use-macro use-macro="here/docma_queue/macros/listings">

</metal:use-macro>
</tal:define>

</tal:condition>

   </td>
  </tr>
 </tbody>
</table>

</metal:block>
</metal:block>
</html>
