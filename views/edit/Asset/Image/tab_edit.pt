<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva"
>
<metal:use-macro use-macro="here/macro_asset_edit/macros/editor">

<metal:fill-slot fill-slot="info">
  <script type="text/javascript"
    tal:attributes="src here/cropping.js/absolute_url">
  </script>
  <div class="info">
    <h3 i18n:translate="">
      <img tal:replace="structure icon" i18n:name="" />
      image info
    </h3>
    <tal:condition condition="not: model/hires_image">
      <h4 i18n:translate="">format</h4>
      <p>
        <span tal:replace="python: model.web_format.lower()" /> <tal:block i18n:translate="">image</tal:block>
      </p>
      <h4 i18n:translate="">dimensions</h4>
      <p tal:define="
        img_width python: model.getDimensions()[0];
        img_height python: model.getDimensions()[1];
        "
        tal:on-error="string: unknown"
        tal:replace="string:${img_width}x${img_height} pixels">
        123x456
      </p>
    </tal:condition>
    <tal:condition condition="model/hires_image">
      <h4 i18n:translate="">format</h4>
      <p>
        <span tal:replace="python: model.web_format.lower()">format</span>
        <tal:block i18n:translate="">image</tal:block>
      </p>
      <h4 i18n:translate="">dimensions</h4>
      <p tal:define="
        image_width python: model.getDimensions()[0];
        image_height python: model.getDimensions()[1];
        scale_width python: model.getCanonicalWebScale()[0];
        scale_height python: model.getCanonicalWebScale()[1];
      ">
        <span tal:on-error="string: unknown"
          tal:replace="string:${image_width}x${image_height} pixels"
        />
        <tal:condition condition="python:
          image_width != scale_width or
          image_height != scale_height"><br />
          <tal:block i18n:translate="">scaled to
            <span tal:replace="string:${scale_width}x${scale_height}"
              tal:on-error="string: unknown"
              i18n:name="WxH"
            />
          pixels</tal:block>
        </tal:condition>
      </p>
    </tal:condition>
    <tal:block tal:condition="model/thumbnail_image">
      <h4 i18n:translate="">thumbnail</h4>
      <p style="margin-top:0.4em">
        <img tal:replace="structure python:model.tag(thumbnail=1)" /><br />
      </p>
    </tal:block>
    <h4 i18n:translate="">original</h4>
    <p tal:condition="model/canScale">
      <tal:block define="
        format python: model.getFormat().lower();
        notweb python: not format in ('jpeg', 'gif', 'png')"
        tal:condition="notweb">
        <tal:in replace="format">ext</tal:in>
        <span i18n:translate="" tal:omit-tag="">format</span><br/>
      </tal:block>
      <a class="underline"
        title="view the original image: alt-v"
        accesskey="v"
        tal:attributes="href python:model.url(hires=1)"
        i18n:attributes="title">
        <tal:block i18n:translate="">view unscaled image</tal:block>
      </a>
    </p>
    <h4 i18n:translate="">orientation</h4>
    <p tal:define="
      orientation model/getOrientation;
      klass model/getOrientationClass"
      tal:condition="model/hires_image">
      <span tal:content="orientation"
        tal:attributes="class string:${klass} orientation">
        square or portrait
      </span>
    </p>
    <tal:portlets tal:replace="structure provider:smiassetmetadata" />
  </div>
</metal:fill-slot>

<metal:fill-slot fill-slot="additional_tools">
  <form method="post"
    name="editform.scaling"
    action="."
    enctype="multipart/form-data"
    tal:condition="model/canScale">
    <table class="listing">
      <thead>
        <tal:block replace="nothing">
          ______________ top controls row ______________
        </tal:block>
        <tr class="top-controls">
          <td colspan="2">
            <h3 i18n:translate="">
              format and scaling
            </h3>
          </td>
        </tr>
      </thead>
      <tbody tal:define="fields here/scale_form/get_fields">
        <tr>
          <th width="33%"
            i18n:translate="">
            aspect
          </th>
          <th i18n:translate="">
            content
          </th>
        </tr>
        <tal:repeat repeat="field fields">
          <tal:define define="iterate repeat/field/odd">
            <tr tal:attributes="class python:iterate and 'odd' or 'even'">
              <td class="designator">
                <label tal:content="field/title"
                  tal:attributes="for field/id">
                  title</label><span class="warning"
                  tal:condition="field/is_required">*</span>
                <p tal:content="structure python:field.get_value('description')">
                  comments here (field description)
                </p>
              </td>
              <td class="field">
                <input tal:replace="structure python:field.render_from_request(request)" />
              </td>
            </tr>
          </tal:define>
        </tal:repeat>
      </tbody>
      <tfoot>
        <tr class="controls">
          <td>
            <input class="button transporter"
              type="button"
              value="set crop coordinates..."
              title="specify the center of the area to crop by clicking in the image: alt-o"
              accesskey="o"
              tal:define="asset_context python:request.model"
              tal:attributes="onclick python:'openlookupWindow(\'%s/edit/lookup_cropcoordinates?asset_context=%s\');; ' % (asset_context.absolute_url(), '/'.join(asset_context.getPhysicalPath()))"
              i18n:attributes="title;value"
            />
          </td>
          <td class="align-right">
            <input class="button"
              type="submit"
              name="scale_submit:method"
              value="change"
              title="access key: alt-c"
              accesskey="c"
              i18n:attributes="title;value"
            />
          </td>
        </tr>
      </tfoot>
    </table>
  </form>

  <metal:block use-macro="here/macro_asset_edit/macros/uploader" />

  <table class="listing"
    tal:define="
    web_format python:model.getWebFormat();
    web_format_available python:web_format in ('PNG', 'JPEG', 'GIF');
    ">
    <thead>
      <tal:block replace="nothing">
        ______________ top controls row ______________
      </tal:block>
      <tr class="top-controls">
        <td colspan="2">
          <h3 i18n:translate=""
            tal:attributes="title string:true web format: $web_format">
            image
          </h3>
        </td>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th i18n:translate="">
          web configuration
        </th>
      </tr>
      <tr tal:define="scale_height python: model.getCanonicalWebScale()[1] + 1"
        tal:condition="web_format_available"
        tal:attributes="style string:height:${scale_height}px">
        <td class="field" style="padding:0">
          <div style="position:absolute">
            <img tal:replace="structure python:model.tag()"/>
          </div>
        </td>
      </tr>
      <tr tal:condition="not:web_format_available">
        <td class="field alert"
          i18n:translate="">
          This image is in <tal:in replace="web_format" i18n:name="image_format"/> format
          and won't display in a web browser.
        </td>
      </tr>
    </tbody>
  </table>
</metal:fill-slot>

</metal:use-macro>
</html>
