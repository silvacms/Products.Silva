<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva"
>
<metal:block use-macro="here/macro_asset_edit/macros/editor">
<metal:fill-slot fill-slot="info">
  <div class="info">
    <h3 i18n:translate="">
      <img tal:replace="structure icon" i18n:name="icon"/>
      file info
    </h3>
    <h4 i18n:translate="">file mime type</h4>
    <p tal:define="mime_type model/get_mime_type"
      tal:condition="mime_type"
      tal:content="mime_type">
      mime type
    </p>
    <h4 i18n:translate="">file size</h4>
    <p>
      <span tal:define="size model/get_file_size"
        tal:attributes="title string: ${size}"
        tal:replace="python:mangle.Bytes(size)" /> 
    </p>
    <h4 i18n:translate="">link to file</h4>
    <p>
      <a class="underline"
        title="download"
        tal:define="url model/absolute_url"
        tal:content="model/get_title_or_id"
        tal:attributes="href url"
        i18n:attributes="title">
        link
      </a>
    </p>
    <tal:condition 
      tal:define="path model/getFileSystemPath"
      tal:condition="python:user.has_role(['Manager'], model) and path">
      <tal:comment><!-- this works only for ExtFile, not blobs --></tal:comment>
      <h4 i18n:translate="">file system path</h4>
      <p tal:content="structure python: ' / '.join(path.split('/'))">
        path
      </p>
    </tal:condition>
    <tal:portlets tal:replace="structure provider:smiportletmanager" />
  </div>
</metal:fill-slot>

<metal:fill-slot fill-slot="additional_tools">
<tal:cond condition="model/can_edit_text">
 <form method="post"
  action="."
  name="form"
  enctype="multipart/form-data">
  <table class="listing">
    <thead>
      <tal:block replace="nothing">
        ______________ inter-controls row ______________
      </tal:block>
      <tr class="top-controls">
        <td>
          <h3 i18n:translate="">
            edit textual content
          </h3>
        </td>
      </tr>
    </thead>

   <tal:cond condition="not:model/is_editable_size">
    <tbody>
     <tr class="odd">
      <td i18n:translate="">
        Text content is too large to be edited through Silva. Please upload changes.
      </td>
     </tr>
    </tbody>
   </tal:cond>

   <tal:cond condition="model/is_editable_size">
    <tbody tal:define="fields python:here.text_edit_form.get_fields()">
      <tal:repeat repeat="field fields">
      <tal:define define="iterate repeat/field/odd">
      <tr>
        <th>
          <label tal:content="structure field/title"
            tal:attributes="for field/id"
            i18n:translate="">
            title
          </label>
        </th>
      </tr>
      <tr class="odd">
        <td>
          <textarea tal:replace="structure python:field.render_from_request(request)" />
        </td>
      </tr>
      </tal:define>
      </tal:repeat>
    </tbody>
    <tfoot>
      <tr class="controls">
        <td class="align-right"
          colspan="2">
          <input class="button"
            type="submit"
            name="save_text_content:method"
            value="save text content"
            title="access key: alt-c"
            accesskey="c"
            i18n:attributes="value;title"
          />
        </td>
      </tr>
    </tfoot>
   </tal:cond>
  </table>
 </form>
 </tal:cond>
  <metal:block use-macro="here/macro_asset_edit/macros/uploader" />
</metal:fill-slot>
</metal:block>


</html>
